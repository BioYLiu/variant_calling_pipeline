

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quickstart &mdash; vcr 0.0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="vcr 0.0.1 documentation" href="index.html"/>
        <link rel="next" title="Bonus Ducks" href="bonus-ducks.html"/>
        <link rel="prev" title="Command line options" href="command-line-options.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> vcr</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="command-line-options.html">Command line options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="command-line-options.html#required-arguments">Required arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="command-line-options.html#optional-arguments">Optional arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="command-line-options.html#compute-cluster-options">Compute cluster options</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-pipeline-on-compute-cluster">Run pipeline on Compute cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-pipeline">Run pipeline</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bonus-ducks.html">Bonus Ducks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bonus-ducks.html#run-only-a-part-of-variant-calling-step">Run only a part of variant calling step</a></li>
<li class="toctree-l2"><a class="reference internal" href="bonus-ducks.html#run-variant-calling-step-on-selected-samples-provided-in-filenames-txt">Run variant calling step on selected samples provided in filenames.txt.</a></li>
<li class="toctree-l2"><a class="reference internal" href="bonus-ducks.html#run-core-prep-and-core-steps-on-selected-files">Run core_prep and core steps on selected files</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">vcr</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Quickstart</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/quick-start.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="quickstart">
<span id="quick-start"></span><h1>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline">¶</a></h1>
<div class="section" id="input">
<h2>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h2>
<p>Input is a directory(-readsdir) containing SE/PE reads and a config file where all the configuration settings for the pipeline are set. This config file settings will be used universally on all samples available in readsdir. An example <a class="reference external" href="https://github.com/alipirani88/variant_calling_pipeline/blob/master/config">config</a> file with default parameters are included in the pipeline folder. You can customize this config file and provide it with the -config argument. Detailed information in section [Customizing Config file](#customizing-config-file)</p>
<p>Apart from standard Miseq/Hiseq fastq naming extensions (R1_001_final.fastq.gz), other acceptable fastq extensions are: R1.fastq.gz/_R1.fastq.gz, 1_combine.fastq.gz, 1_sequence.fastq.gz, _forward.fastq.gz, _1.fastq.gz/.1.fastq.gz.</p>
</div>
<div class="section" id="run-pipeline-on-compute-cluster">
<h2>Run pipeline on Compute cluster<a class="headerlink" href="#run-pipeline-on-compute-cluster" title="Permalink to this headline">¶</a></h2>
<p>The variant calling can be run in parallel on each sample using the -cluster argument. Set the pbs resources such as resources(-l), email(-M), queue(-q), flux_account(-A) and notification(-m) under [scheduler] section in config file. For more details, check out UMICH <a class="reference external" href="http://arc-ts.umich.edu/systems-and-services/flux/">flux</a> website.</p>
<p>Possible options for -cluster option(Supported system: pbs):</p>
<p><strong>local</strong> : This is the default option. When this option is set, the pipeline will analyze each sample one after the another. This will not make use of multiple cores present in your system or clusters. Use this option for few number of samples or for testing purposes.</p>
<p><strong>parallel-local</strong> :  This option will run the pipeline and analyze samples in parallel but on a local system. This is preferred for less than 20 sample size input and multiple core local system.</p>
<p><strong>cluster</strong> : This option will run the pipeline on a single cluster. This option is similar to local but will rather run on a cluster node. It will not make use of multiple cores present on a cluster. Use this option for few number of samples or for testing purposes or for few number of large size samples which requires multiple cores to analyze individual samples.</p>
<p><strong>parallel-cluster</strong> : The pipeline is optimized for this option. When this option is set, the pipeline will run everything on a cluster making use of all the cores available. This option will also submit individual jobs for each sample seperately and whenever needed. When you set this option for each step in the pipeline, make sure all the jobs submitted by the pipeline at each step is completed before proceeding to another step.</p>
</div>
<div class="section" id="run-pipeline">
<h2>Run pipeline<a class="headerlink" href="#run-pipeline" title="Permalink to this headline">¶</a></h2>
<p>Assuming you want to generate core snps for more than a few hundred samples and run the analysis in parallel on cluster(Time and memory efficient). The default pbs resources used for parallel jobs are:</p>
<div class="highlight-python"><div class="highlight"><pre>nodes=1:ppn=4,pmem=4000mb,walltime=24:00:00
</pre></div>
</div>
<p>See option resources in scheduler section of <a class="reference external" href="https://github.com/alipirani88/variant_calling_pipeline/blob/master/config">config</a> file. Detailed information in section [Customizing Config file](#customizing-config-file)</p>
<ol class="arabic simple">
<li>Run variant calling step (All) on a set of PE reads with default parameters</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre>python /nfs/esnitkin/bin_group/pipeline/Github/variant_calling_pipeline/variant_call.py -type PE -readsdir /Path-To-Your/test_readsdir/ -outdir /Path/test_output_core/ -analysis output_prefix -index MRSA_USA_300 -steps All -cluster parallel-cluster
</pre></div>
</div>
<p>The above command will run variant calling (step 1) pipeline on a set of PE reads residing in test_readsdir. The results will be saved in output directory test_output_core. The config file contains options for some frequently used reference genome. To know which reference genomes are included in config file, look up the [config]() file or check the help menu of the pipeline.</p>
<p>The results of variant calling will be placed in an individual folder generated for each sample in output directory. A log file for each sample will be generated and can be found in each sample folder inside the out directory. A single log file of this step will be generated in main output directory. For more information on log file prefix and convention, please refer [log](#log) section below.</p>
<ol class="arabic simple" start="2">
<li>Run core_prep step to generate files for core SNP calling.</li>
</ol>
<p>Run this steps to generate various intermediate files that will be used for generating core SNPs.</p>
<div class="highlight-python"><div class="highlight"><pre>python /nfs/esnitkin/bin_group/pipeline/Github/variant_calling_pipeline/variant_call.py -type PE -readsdir /Path-To-Your/test_readsdir/ -outdir /Path/test_output_core/ -analysis output_prefix -index MRSA_USA_300 -steps core_prep -cluster parallel-cluster
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Run core step to generate final core SNP consensus fasta files.</li>
</ol>
<p>Since this step compares multiple files simultaneously and involves multiple I/O operations, It is recommended to provide higher memory compute resources.</p>
<p>example:</p>
<div class="highlight-python"><div class="highlight"><pre>nodes=1:ppn=4,mem=47000mb,walltime=24:00:00
</pre></div>
</div>
<p>Replace the resources option in scheduler section of config file with the above line before running the command.</p>
<div class="highlight-python"><div class="highlight"><pre>python /nfs/esnitkin/bin_group/pipeline/Github/variant_calling_pipeline/variant_call.py -type PE -readsdir /Path-To-Your/test_readsdir/ -outdir /Path/test_output_core/ -analysis output_prefix -index MRSA_USA_300 -steps core -cluster parallel-cluster
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>Generate various pipeline reports and results folder</li>
</ol>
<dl class="docutils">
<dt>::</dt>
<dd>python /nfs/esnitkin/bin_group/pipeline/Github/variant_calling_pipeline/variant_call.py -type PE -readsdir /Path-To-Your/test_readsdir/ -outdir /Path/test_output_core/ -analysis output_prefix -index MRSA_USA_300 -steps report -cluster parallel-cluster</dd>
</dl>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bonus-ducks.html" class="btn btn-neutral float-right" title="Bonus Ducks">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="command-line-options.html" class="btn btn-neutral" title="Command line options"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Ali Pirani.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>